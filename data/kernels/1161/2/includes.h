#define MASK_WIDTH 3    //Here MASK_WIDTH = MASK_HEIGHT = 2*N + 1 where N is half-width of the chosen square mask
#define TILE_WIDTH 8   //Tile Width = Tile Height
#define W (TILE_WIDTH + MASK_WIDTH - 1) //mask_width-1 for the halo elements and tile_width for internal elements
//new series 
