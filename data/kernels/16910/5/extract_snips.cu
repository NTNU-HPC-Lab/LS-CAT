#include "includes.h"
const int  Nthreads = 1024, maxFR = 5000, NrankMax = 6;
//////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////
__global__ void extract_snips(const double *Params, const int *st, const int *id, const int *counter, const float *dataraw,  float *WU){

int nt0, tidx, tidy, bid, ind, NT, Nchan, Nmax;

NT        = (int) Params[0];
nt0       = (int) Params[4];
Nchan     = (int) Params[9];

tidx 		= threadIdx.x;
bid 		= blockIdx.x;

Nmax = min(maxFR, counter[1]);

for(ind=0; ind<Nmax;ind++)
if (id[ind]==bid){
tidy 		= threadIdx.y;
while (tidy<Nchan){
WU[tidx+tidy*nt0 + nt0*Nchan * ind] = dataraw[st[ind]+tidx + NT * tidy];
tidy+=blockDim.y;
}
}
}